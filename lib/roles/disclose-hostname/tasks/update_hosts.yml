- name: Update hosts files for each node
  copy:
    src: "{{ playbook_dir }}/hosts-file/hosts"
    dest: /tmp/simple-kubernetes-hosts
  when: resolve_in_hosts is defined

- name: Apply new hosts file
  shell: |
    sed -i '/#BEGIN --generated by simple-kubernetes/,/#END --generated by simple-kubernetes/d' /etc/hosts
    cat /tmp/simple-kubernetes-hosts >> /etc/hosts
  args:
    executable: /bin/bash
  when: resolve_in_hosts is defined